<?xml version="1.0" encoding="UTF-8"?>
<templates xml:space="preserve">

    <t t-name="ecommerce_integration.ShopManagementDashboard">
        <div class="o_shop_management_dashboard">
            <div class="o_shop_dashboard_container">
                <!-- Sidebar với danh sách platforms -->
                <div class="o_platform_sidebar">
                    <div class="o_sidebar_header">
                        <h4>Sàn giao dịch</h4>
                    </div>
                    <div class="o_platform_list">
                        <t t-foreach="state.platforms" t-as="platform" t-key="platform.id">
                            <div class="o_platform_item"
                                 t-att-class="state.selectedPlatform?.id === platform.id ? 'active' : ''"
                                 t-on-click="() => this.selectPlatform(platform)"
                                 t-attf-style="border-left-color: #{platform.color};">
                                <div class="o_platform_name">
                                    <i class="fa fa-circle" t-attf-style="color: #{platform.color};"/>
                                    <span t-esc="platform.name"/>
                                </div>
                                <div class="o_platform_count">
                                    <span class="badge badge-info" t-esc="platform.shop_count"/>
                                </div>
                            </div>
                        </t>
                    </div>
                </div>

                <!-- Main content với danh sách shops -->
                <div class="o_shop_content">
                    <div class="o_content_header">
                        <h3 t-if="state.selectedPlatform">
                            <t t-esc="state.selectedPlatform.name"/>
                        </h3>
                        <button class="btn btn-primary o_connect_button"
                                t-if="state.selectedPlatform"
                                t-on-click="openConnectWizard">
                            <i class="fa fa-plus"/> Kết nối với <t t-esc="state.selectedPlatform.name"/>
                        </button>
                    </div>

                    <!-- Danh sách gian hàng -->
                    <div class="o_shops_list">
                        <t t-if="state.shops.length > 0">
                            <table class="table table-hover o_shops_table">
                                <thead>
                                    <tr>
                                        <th>Tên gian hàng</th>
                                        <th>ID gian hàng</th>
                                        <th>Trạng thái kết nối</th>
                                        <th>Đồng bộ lần cuối</th>
                                        <th>Hành động</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <t t-foreach="state.shops" t-as="shop" t-key="shop.id">
                                        <tr t-on-click="() => this.openShopForm(shop.id)" style="cursor: pointer;">
                                            <td>
                                                <strong t-esc="shop.name"/>
                                                <div class="text-muted small" t-if="shop.owner_name">
                                                    <i class="fa fa-user"/> <t t-esc="shop.owner_name"/>
                                                </div>
                                            </td>
                                            <td>
                                                <code t-esc="shop.shop_id"/>
                                            </td>
                                            <td>
                                                <span class="badge" 
                                                      t-att-class="getStatusBadgeClass(shop.status)"
                                                      t-esc="getStatusLabel(shop.status)"/>
                                            </td>
                                            <td>
                                                <span t-esc="formatDate(shop.last_sync_date)"/>
                                            </td>
                                            <td>
                                                <button class="btn btn-sm btn-link" 
                                                        t-on-click.stop="() => this.openShopForm(shop.id)">
                                                    <i class="fa fa-external-link"/> Chi tiết
                                                </button>
                                            </td>
                                        </tr>
                                    </t>
                                </tbody>
                            </table>
                        </t>
                        <t t-else="">
                            <div class="o_empty_state">
                                <div class="text-center py-5">
                                    <i class="fa fa-store fa-3x text-muted mb-3"/>
                                    <h4>Chưa có gian hàng nào</h4>
                                    <p class="text-muted">
                                        Nhấn nút "Kết nối với <t t-esc="state.selectedPlatform?.name"/>" để thêm gian hàng
                                    </p>
                                </div>
                            </div>
                        </t>
                    </div>
                </div>
            </div>
        </div>
    </t>

</templates>
